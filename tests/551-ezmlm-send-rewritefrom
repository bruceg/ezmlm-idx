prompt "ezmlm-send (from):    "

touch "$DIR"/rewritefrom

sendfrom '"My Name 1" <test1@example.org>'
grephdr From: "\"My Name 1\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: '"My Name 1" <test1@example.org>'

sendfrom '"My Name 2" test2@example.org'
grephdr From: "\"My Name 2\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: '"My Name 2" test2@example.org'

sendfrom 'My Name 3 <test3@example.org>'
grephdr From: "My Name 3 via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: 'My Name 3 <test3@example.org>'

sendfrom 'test4@example.org (My Name 4)'
grephdr From: "\"My Name 4\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: 'test4@example.org \(My Name 4\)'

sendfrom 'test5@example.org'
grephdr From: "\"test5@example.org\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: 'test5@example.org'

rm -f "$DIR"/rewritefrom

sendfrom 'test6@yahoo.com'
grephdr From: "\"test6@yahoo.com\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: 'test6@yahoo.com'

sendfrom '"My Name 7" <test7@yahoo.com>'
grephdr From: "\"My Name 7\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: '"My Name 7" <test7@yahoo.com>'

sendfrom 'My Name 8 <test8@yahoo.com>'
grephdr From: "My Name 8 via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: 'My Name 8 <test8@yahoo.com>'

touch "$DIR"/rewritefrom

sendfrom '=?iso-8859-1?Q?My=20N=E4m=E9=209?= <test9@example.org>'
grephdr From: "=\\?iso-8859-1\\?Q\\?My=20N=E4m=E9=209\\?= via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: '=\?iso-8859-1\?Q\?My=20N=E4m=E9=209\?= <test9@example.org>'

sendfrom '=?utf-8?B?77yt772ZIMORw6ZtIDEw?= <test10@example.org>'
grephdr From: "=\\?utf-8\\?B\\?77yt772ZIMORw6ZtIDEw\\?= via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: '=\?utf-8\?B\?77yt772ZIMORw6ZtIDEw\?= <test10@example.org>'

sendfrom 'My Name 11 <test11@example.org>' 'Reply To 11 <reply11@example.org>'
grephdr From: "My Name 11 via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: 'Reply To 11 <reply11@example.org>'

sendfrom test12@example.org test12@example.org
grephdr From: "\"test12@example.org\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: 'test12@example.org'

touch "$DIR"/replytolist

sendfrom '"My Name 13" <test13@example.org>'
grephdr From: "\"My Name 13\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: "<${LIST}@${HOST}>"
singlehdr Cc:
grephdr Cc: '"My Name 13" <test13@example.org>'

cat >"$TMP" <<EOF
From: test14@example.org
To: ${LIST}@${HOST}
Cc: cc14@example.org
Subject: carbon-copied test post

message goes here
EOF
${EZBIN}/ezmlm-send "$DIR" <"$TMP" >"$ERR" 2>&1 || \
    fatal "failed to produce post"
unfoldhdrs
grephdr From: "\"test14@example.org\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: "<${LIST}@${HOST}>"
singlehdr Cc:
grephdr Cc: 'cc14@example.org, test14@example.org'

cat >"$TMP" <<EOF
From: My Test 15 <test15@example.org>
To: ${LIST}@${HOST}
Cc: "Carbon Copy 15" <cc15@example.org>,
 <cc15-addtl@example.org>
Subject: carbon-copied test post

message goes here
EOF
${EZBIN}/ezmlm-send "$DIR" <"$TMP" >"$ERR" 2>&1 || \
    fatal "failed to produce post"
unfoldhdrs
grephdr From: "My Test 15 via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: "<${LIST}@${HOST}>"
singlehdr Cc:
grephdr Cc: '"Carbon Copy 15" <cc15@example.org>, <cc15-addtl@example.org>, My Test 15 <test15@example.org>'

cat >"$TMP" <<EOF
From: test16@example.org
To: ${LIST}@${HOST}
Cc: cc16@example.org
Subject: multipart/alternative MIME message
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0000000062ea6ef9772a44f3a30a"

--0000000062ea6ef9772a44f3a30a
Content-Type: text/plain; charset="US-ASCII"

Hello, world!

--0000000062ea6ef9772a44f3a30a
Content-Type: text/html; charset="US-ASCII"

Hello, world!<br/> 
--0000000062ea6ef9772a44f3a30a--
EOF
${EZBIN}/ezmlm-send "$DIR" <"$TMP" >"$ERR" 2>&1 || \
    fatal "failed to produce post"
unfoldhdrs
grephdr From: "\"test16@example.org\" via ${LIST} <${LIST}@${HOST}>$"
singlehdr Reply-To:
grephdr Reply-To: "<${LIST}@${HOST}>"
singlehdr Cc:
grephdr Cc: 'cc16@example.org, test16@example.org'

rm -f "$DIR"/rewritefrom "$DIR"/replytolist

echo OK
